package com.zes.device.models;

import com.zes.device.ZES_SQLGenerator;
import com.zes.device.config.ZES_MysqlConfig;

import java.sql.*;

public class ZES_Type3 extends ZES_TypeInfluxDB
{
    private static final ZES_Data[] ZES_gv_DATA_MAP =
    {
        new ZES_Data("flag",20,4),
        new ZES_Data("cam0on",24,2),
        new ZES_Data("cam0off",26,2),
        new ZES_Data("cam1on",28,2),
        new ZES_Data("cam1off",30,2),
        new ZES_Data("cam2on",32,2),
        new ZES_Data("cam2off",34,2),
        new ZES_Data("cam3on",36,2),
        new ZES_Data("cam3off",38,2),
        new ZES_Data("cam4on",40,2),
        new ZES_Data("cam4off",42,2),
        new ZES_Data("cam5on",44,2),
        new ZES_Data("cam5off",46,2),
        new ZES_Data("cam6on",48,2),
        new ZES_Data("cam6off",50,2),
        new ZES_Data("cam7on",52,2),
        new ZES_Data("cam7off",54,2),
        new ZES_Data("cam8on",56,2),
        new ZES_Data("cam8off",58,2),
        new ZES_Data("cam9on",60,2),
        new ZES_Data("cam9off",62,2),
        new ZES_Data("cam10on",64,2),
        new ZES_Data("cam10off",66,2),
        new ZES_Data("cam11on",68,2),
        new ZES_Data("cam11off",70,2),
        new ZES_Data("cam12on",72,2),
        new ZES_Data("cam12off",74,2),
        new ZES_Data("cam13on",76,2),
        new ZES_Data("cam13off",78,2),
        new ZES_Data("cam14on",80,2),
        new ZES_Data("cam14off",82,2),
        new ZES_Data("cam15on",84,2),
        new ZES_Data("cam15off",86,2),
        new ZES_Data("cam16on",88,2),
        new ZES_Data("cam16off",90,2),
        new ZES_Data("cam17on",92,2),
        new ZES_Data("cam17off",94,2),
        new ZES_Data("cam18on",96,2),
        new ZES_Data("cam18off",98,2),
        new ZES_Data("cam19on",100,2),
        new ZES_Data("cam19off",102,2),
        new ZES_Data("cam20on",104,2),
        new ZES_Data("cam20off",106,2),
        new ZES_Data("cam21on",108,2),
        new ZES_Data("cam21off",110,2),
        new ZES_Data("cam22on",112,2),
        new ZES_Data("cam22off",114,2),
        new ZES_Data("cam23on",116,2),
        new ZES_Data("cam23off",118,2),
        new ZES_Data("cam24on",120,2),
        new ZES_Data("cam24off",122,2),
        new ZES_Data("cam25on",124,2),
        new ZES_Data("cam25off",126,2),
        new ZES_Data("cam26on",128,2),
        new ZES_Data("cam26off",130,2),
        new ZES_Data("cam27on",132,2),
        new ZES_Data("cam27off",134,2),
        new ZES_Data("cam28on",136,2),
        new ZES_Data("cam28off",138,2),
        new ZES_Data("cam29on",140,2),
        new ZES_Data("cam29off",142,2),
        new ZES_Data("cam30on",144,2),
        new ZES_Data("cam30off",146,2),
        new ZES_Data("cam31on",148,2),
        new ZES_Data("cam31off",150,2),
        new ZES_Data("cam32on",152,2),
        new ZES_Data("cam32off",154,2),
        new ZES_Data("cam33on",156,2),
        new ZES_Data("cam33off",158,2),
        new ZES_Data("cam34on",160,2),
        new ZES_Data("cam34off",162,2),
        new ZES_Data("cam35on",164,2),
        new ZES_Data("cam35off",166,2),
        new ZES_Data("cam36on",168,2),
        new ZES_Data("cam36off",170,2),
        new ZES_Data("cam37on",172,2),
        new ZES_Data("cam37off",174,2),
        new ZES_Data("cam38on",176,2),
        new ZES_Data("cam38off",178,2),
        new ZES_Data("cam39on",180,2),
        new ZES_Data("cam39off",182,2),
        new ZES_Data("cam40on",184,2),
        new ZES_Data("cam40off",186,2),
        new ZES_Data("cam41on",188,2),
        new ZES_Data("cam41off",190,2),
        new ZES_Data("cam42on",192,2),
        new ZES_Data("cam42off",194,2),
        new ZES_Data("cam43on",196,2),
        new ZES_Data("cam43off",198,2),
        new ZES_Data("cam44on",200,2),
        new ZES_Data("cam44off",202,2),
        new ZES_Data("cam45on",204,2),
        new ZES_Data("cam45off",206,2),
        new ZES_Data("cam46on",208,2),
        new ZES_Data("cam46off",210,2),
        new ZES_Data("cam47on",212,2),
        new ZES_Data("cam47off",214,2),
        new ZES_Data("cam48on",216,2),
        new ZES_Data("cam48off",218,2),
        new ZES_Data("cam49on",220,2),
        new ZES_Data("cam49off",222,2),
        new ZES_Data("cam0en",224,1),
        new ZES_Data("cam0fen",225,1),
        new ZES_Data("cam1en",226,1),
        new ZES_Data("cam1fen",227,1),
        new ZES_Data("cam2en",228,1),
        new ZES_Data("cam2fen",229,1),
        new ZES_Data("cam3en",230,1),
        new ZES_Data("cam3fen",231,1),
        new ZES_Data("cam4en",232,1),
        new ZES_Data("cam4fen",233,1),
        new ZES_Data("cam5en",234,1),
        new ZES_Data("cam5fen",235,1),
        new ZES_Data("cam6en",236,1),
        new ZES_Data("cam6fen",237,1),
        new ZES_Data("cam7en",238,1),
        new ZES_Data("cam7fen",239,1),
        new ZES_Data("cam8en",240,1),
        new ZES_Data("cam8fen",241,1),
        new ZES_Data("cam9en",242,1),
        new ZES_Data("cam9fen",243,1),
        new ZES_Data("cam10en",244,1),
        new ZES_Data("cam10fen",245,1),
        new ZES_Data("cam11en",246,1),
        new ZES_Data("cam11fen",247,1),
        new ZES_Data("cam12en",248,1),
        new ZES_Data("cam12fen",249,1),
        new ZES_Data("cam13en",250,1),
        new ZES_Data("cam13fen",251,1),
        new ZES_Data("cam14en",252,1),
        new ZES_Data("cam14fen",253,1),
        new ZES_Data("cam15en",254,1),
        new ZES_Data("cam15fen",255,1),
        new ZES_Data("cam16en",256,1),
        new ZES_Data("cam16fen",257,1),
        new ZES_Data("cam17en",258,1),
        new ZES_Data("cam17fen",259,1),
        new ZES_Data("cam18en",260,1),
        new ZES_Data("cam18fen",261,1),
        new ZES_Data("cam19en",262,1),
        new ZES_Data("cam19fen",263,1),
        new ZES_Data("cam20en",264,1),
        new ZES_Data("cam20fen",265,1),
        new ZES_Data("cam21en",266,1),
        new ZES_Data("cam21fen",267,1),
        new ZES_Data("cam22en",268,1),
        new ZES_Data("cam22fen",269,1),
        new ZES_Data("cam23en",270,1),
        new ZES_Data("cam23fen",271,1),
        new ZES_Data("cam24en",272,1),
        new ZES_Data("cam24fen",273,1),
        new ZES_Data("cam25en",274,1),
        new ZES_Data("cam25fen",275,1),
        new ZES_Data("cam26en",276,1),
        new ZES_Data("cam26fen",277,1),
        new ZES_Data("cam27en",278,1),
        new ZES_Data("cam27fen",279,1),
        new ZES_Data("cam28en",280,1),
        new ZES_Data("cam28fen",281,1),
        new ZES_Data("cam29en",282,1),
        new ZES_Data("cam29fen",283,1),
        new ZES_Data("cam30en",284,1),
        new ZES_Data("cam30fen",285,1),
        new ZES_Data("cam31en",286,1),
        new ZES_Data("cam31fen",287,1),
        new ZES_Data("cam32en",288,1),
        new ZES_Data("cam32fen",289,1),
        new ZES_Data("cam33en",290,1),
        new ZES_Data("cam33fen",291,1),
        new ZES_Data("cam34en",292,1),
        new ZES_Data("cam34fen",293,1),
        new ZES_Data("cam35en",294,1),
        new ZES_Data("cam35fen",295,1),
        new ZES_Data("cam36en",296,1),
        new ZES_Data("cam36fen",297,1),
        new ZES_Data("cam37en",298,1),
        new ZES_Data("cam37fen",299,1),
        new ZES_Data("cam38en",300,1),
        new ZES_Data("cam38fen",301,1),
        new ZES_Data("cam39en",302,1),
        new ZES_Data("cam39fen",303,1),
        new ZES_Data("cam40en",304,1),
        new ZES_Data("cam40fen",305,1),
        new ZES_Data("cam41en",306,1),
        new ZES_Data("cam41fen",307,1),
        new ZES_Data("cam42en",308,1),
        new ZES_Data("cam42fen",309,1),
        new ZES_Data("cam43en",310,1),
        new ZES_Data("cam43fen",311,1),
        new ZES_Data("cam44en",312,1),
        new ZES_Data("cam44fen",313,1),
        new ZES_Data("cam45en",314,1),
        new ZES_Data("cam45fen",315,1),
        new ZES_Data("cam46en",316,1),
        new ZES_Data("cam46fen",317,1),
        new ZES_Data("cam47en",318,1),
        new ZES_Data("cam47fen",319,1),
        new ZES_Data("cam48en",320,1),
        new ZES_Data("cam48fen",321,1),
        new ZES_Data("cam49en",322,1),
        new ZES_Data("cam49fen",323,1),
        new ZES_Data("cam0state",328,1),
        new ZES_Data("cam1state",329,1),
        new ZES_Data("cam2state",330,1),
        new ZES_Data("cam3state",331,1),
        new ZES_Data("cam4state",332,1),
        new ZES_Data("cam5state",333,1),
        new ZES_Data("cam6state",334,1),
        new ZES_Data("cam7state",335,1),
        new ZES_Data("cam8state",336,1),
        new ZES_Data("cam9state",337,1),
        new ZES_Data("cam10state",338,1),
        new ZES_Data("cam11state",339,1),
        new ZES_Data("cam12state",340,1),
        new ZES_Data("cam13state",341,1),
        new ZES_Data("cam14state",342,1),
        new ZES_Data("cam15state",343,1),
        new ZES_Data("cam16state",344,1),
        new ZES_Data("cam17state",345,1),
        new ZES_Data("cam18state",346,1),
        new ZES_Data("cam19state",347,1),
        new ZES_Data("cam20state",348,1),
        new ZES_Data("cam21state",349,1),
        new ZES_Data("cam22state",350,1),
        new ZES_Data("cam23state",351,1),
        new ZES_Data("cam24state",352,1),
        new ZES_Data("cam25state",353,1),
        new ZES_Data("cam26state",354,1),
        new ZES_Data("cam27state",355,1),
        new ZES_Data("cam28state",356,1),
        new ZES_Data("cam29state",357,1),
        new ZES_Data("cam30state",358,1),
        new ZES_Data("cam31state",359,1),
        new ZES_Data("cam32state",360,1),
        new ZES_Data("cam33state",361,1),
        new ZES_Data("cam34state",362,1),
        new ZES_Data("cam35state",363,1),
        new ZES_Data("cam36state",364,1),
        new ZES_Data("cam37state",365,1),
        new ZES_Data("cam38state",366,1),
        new ZES_Data("cam39state",367,1),
        new ZES_Data("cam40state",368,1),
        new ZES_Data("cam41state",369,1),
        new ZES_Data("cam42state",370,1),
        new ZES_Data("cam43state",371,1),
        new ZES_Data("cam44state",372,1),
        new ZES_Data("cam45state",373,1),
        new ZES_Data("cam46state",374,1),
        new ZES_Data("cam47state",375,1),
        new ZES_Data("cam48state",376,1),
        new ZES_Data("cam49state",377,1),
    };
    private static final String ZES_gv_Type = "3";
    private static final String ZES_gv_tableName = "pms_real_data_3";

    public ZES_Type3(long timestamp, byte[] bytes, String ictNumber)
    {
        super(timestamp, bytes, ictNumber);
    }

    @Override
    public ZES_Type3 ZES_saveRealTime()
    {
        ZES_initPoint(ZES_gv_Type);
        try
        (
                Connection ZES_lv_conn = ZES_MysqlConfig.getConnection();
                PreparedStatement ZES_lv_preparedStatement = ZES_SQLGenerator.findByIctNumber(ZES_lv_conn, ZES_gv_ictNumber, ZES_gv_tableName);
                ResultSet ZES_lv_prevResultSet = ZES_lv_preparedStatement.executeQuery();
        )
        {
            ZES_parse(ZES_gv_DATA_MAP, ZES_lv_prevResultSet);
            if(ZES_gv_hasPrevData)
            {
                ZES_SQLGenerator.update(ZES_lv_conn, ZES_gv_DATA_MAP, ZES_gv_tableName, ZES_gv_ictNumber, ZES_gv_timestamp);
            }
            else
            {
                ZES_SQLGenerator.insert(ZES_lv_conn, ZES_gv_DATA_MAP, ZES_gv_ictNumber, ZES_gv_tableName, ZES_gv_timestamp);
            }
        }
        catch (SQLException e) {
            ZES_parse(ZES_gv_DATA_MAP, null);
            ZES_handleException(e);
        }
        finally
        {
            return this;
        }
    }
}
